function upclick(params){var defaults={element:null,action:"about:blank",action_params:{},maxsize:0,onstart:null,oncomplete:null,dataname:"Filedata",target:null,zindex:"auto"};for(var key in defaults)params[key]=params[key]?params[key]:defaults[key];var element=params.element;"string"==typeof element&&(element=document.getElementById(element));var input,doc=element.ownerDocument,container=doc.createElement("div"),frame_name="frame"+(new Date).getTime().toString().substr(8);container.innerHTML='<iframe name="'+frame_name+'" src="about:blank" onload="this.onload_callback()"></iframe>';var frame=container.childNodes[0];if(frame.onload_callback=function(){var form=doc.createElement("form");container.appendChild(form),form.method="post",form.enctype="multipart/form-data",form.encoding="multipart/form-data",params.target?(form.target=params.target,form.setAttribute("target",params.target)):(form.target=frame_name,form.setAttribute("target",frame_name)),form.action=params.action,form.setAttribute("action",params.action),form.style.margin=0,form.style.padding=0,form.style.height="80px",form.style.width="40px",form.runat="server";var action_params=params.action_params;for(var key in action_params){var hidden=doc.createElement("input");hidden.type="hidden",hidden.name=key,hidden.value=String(action_params[key]),form.appendChild(hidden)}if(params.maxsize){var input_ms=doc.createElement("input");input_ms.type="hidden",input_ms.name="MAX_FILE_SIZE",input_ms.value=String(params.maxsize),form.appendChild(input_ms)}input=doc.createElement("input"),input.name=params.dataname,input.type="file",input.size="1",input.runat="server",form.appendChild(input),input.style.position="absolute",input.style.display="block",input.style.top=0,input.style.left=0,input.style.height=form.style.height,input.style.width="80px",input.style.opacity=0,input.style.filter="alpha(opacity=0)",input.style.fontSize=8,input.style.zIndex=1,input.style.visiblity="hidden",input.style.marginLeft="-40px",input.style.cursor="pointer";var onchange_callback=function(){if(input.value){var onstart=params.onstart;onstart&&onstart(input.value),form.submit()}};input.addEventListener?input.addEventListener("change",onchange_callback,!1):input.attachEvent?input.attachEvent("onpropertychange",function(e){e||(e=window.event),"value"==e.propertyName&&onchange_callback()}):input.onpropertychange=onchange_callback,frame.onload_callback=function(){var ifwin=null;frame.contentWindow?ifwin=frame.contentWindow:frame.contentDocument&&(ifwin=frame.contentDocument.defaultView);var data=ifwin.document.body.innerHTML,oncomplete=params.oncomplete;oncomplete&&oncomplete(data),form.reset()}},frame.style.display="none",frame.width=0,frame.height=0,frame.marginHeight=0,frame.marginWidth=0,doc.body.insertBefore(container,doc.body.firstChild),container.style.position="absolute",container.style.overflow="hidden",container.style.padding=0,container.style.margin=0,container.style.visiblity="hidden",container.style.width="0px",container.style.height="0px","auto"==params.zindex){for(var ziparsed,comp,zi=0,obj=element;"BODY"!=obj.tagName;)comp=obj.currentStyle?obj.currentStyle:getComputedStyle(obj,null),ziparsed=parseInt(comp.zIndex),ziparsed=isNaN(ziparsed)?0:ziparsed,zi+=ziparsed+1,obj=obj.parentNode;container.style.zIndex=zi}else container.style.zIndex=params.zindex;var onmouseout_callback=function(e){e||(e=window.event),container.style.width="0px",container.style.height="0px";var receiver=doc.elementFromPoint(e.clientX,e.clientY);receiver===element&&(container.style.width="40px",container.style.height="80px")};container.addEventListener?container.addEventListener("mouseout",onmouseout_callback,!1):container.attachEvent&&container.attachEvent("onmouseout",onmouseout_callback);var onmousemove_callback=function(e){e||(e=window.event);var x=y=0;e.pageX?x=e.pageX:e.clientX&&(x=e.clientX+(doc.documentElement.scrollLeft?doc.documentElement.scrollLeft:doc.body.scrollLeft)),e.pageY?y=e.pageY:e.clientY&&(y=e.clientY+(doc.documentElement.scrollTop?doc.documentElement.scrollTop:doc.body.scrollTop)),container.style.left=x-20+"px",container.style.top=y-40+"px",container.style.width="40px",container.style.height="80px"};element.addEventListener?element.addEventListener("mousemove",onmousemove_callback,!1):element.attachEvent&&element.attachEvent("onmousemove",onmousemove_callback)}